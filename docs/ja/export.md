# ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ã‚¬ã‚¤ãƒ‰

Laravel Spectrumã¯APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ§˜ã€…ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã§ãã¾ã™ã€‚Postmanã‚„Insomniaãªã©ã®äººæ°—ã®APIãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«ã«ç›´æ¥ã‚¤ãƒ³ãƒãƒ¼ãƒˆå¯èƒ½ãªå½¢å¼ã§å‡ºåŠ›ã—ã¾ã™ã€‚

## ğŸ”— Postmanã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

### åŸºæœ¬çš„ãªã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

```bash
php artisan spectrum:export:postman
```

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ `storage/app/spectrum/postman/collection.json` ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

### ã‚«ã‚¹ã‚¿ãƒ å‡ºåŠ›å…ˆ

```bash
php artisan spectrum:export:postman --output=/path/to/postman_collection.json
```

### ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚ªãƒ—ã‚·ãƒ§ãƒ³

```bash
php artisan spectrum:export:postman \
    --include-examples \
    --include-tests \
    --environment
```

ã‚ªãƒ—ã‚·ãƒ§ãƒ³èª¬æ˜ï¼š
- `--include-examples`: ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹ã‚’å«ã‚ã‚‹
- `--include-tests`: è‡ªå‹•ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç”Ÿæˆ
- `--environment`: ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ç”Ÿæˆ

### ç”Ÿæˆã•ã‚Œã‚‹å†…å®¹

#### ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³æ§‹é€ 

```json
{
  "info": {
    "name": "Laravel API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Authentication",
      "item": [
        {
          "name": "Login",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "login"]
            }
          }
        }
      ]
    }
  ]
}
```

#### ç’°å¢ƒå¤‰æ•°

```json
{
  "name": "Laravel API Environment",
  "values": [
    {
      "key": "base_url",
      "value": "http://localhost:8000",
      "type": "default"
    },
    {
      "key": "bearer_token",
      "value": "",
      "type": "secret"
    }
  ]
}
```

#### ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãƒ†ã‚¹ãƒˆã®ä¾‹ï¼š

```javascript
// ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒã‚§ãƒƒã‚¯
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

// ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ§‹é€ ã®æ¤œè¨¼
pm.test("Response has required fields", function () {
    const jsonData = pm.response.json();
    pm.expect(jsonData).to.have.property('data');
    pm.expect(jsonData.data).to.have.property('id');
    pm.expect(jsonData.data).to.have.property('email');
});

// èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã®ä¿å­˜
if (pm.response.json().token) {
    pm.environment.set("bearer_token", pm.response.json().token);
}
```

## ğŸ¦Š Insomniaã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

### åŸºæœ¬çš„ãªã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

```bash
php artisan spectrum:export:insomnia
```

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ `storage/app/spectrum/insomnia/workspace.json` ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

### ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚ªãƒ—ã‚·ãƒ§ãƒ³

```bash
php artisan spectrum:export:insomnia \
    --workspace-name="My API" \
    --include-environments \
    --folder-structure
```

ã‚ªãƒ—ã‚·ãƒ§ãƒ³èª¬æ˜ï¼š
- `--workspace-name`: ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹å
- `--include-environments`: ç’°å¢ƒè¨­å®šã‚’å«ã‚ã‚‹
- `--folder-structure`: ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã§æ•´ç†

### ç”Ÿæˆã•ã‚Œã‚‹å†…å®¹

#### ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹æ§‹é€ 

```json
{
  "_type": "export",
  "__export_format": 4,
  "__export_date": "2024-01-01T00:00:00.000Z",
  "__export_source": "laravel-spectrum",
  "resources": [
    {
      "_id": "wrk_1",
      "_type": "workspace",
      "name": "Laravel API",
      "description": "Generated by Laravel Spectrum"
    },
    {
      "_id": "env_1",
      "_type": "environment",
      "parentId": "wrk_1",
      "name": "Base Environment",
      "data": {
        "base_url": "http://localhost:8000",
        "bearer_token": ""
      }
    }
  ]
}
```

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ§‹é€ 

```json
{
  "_id": "req_1",
  "_type": "request",
  "parentId": "fld_auth",
  "name": "Create User",
  "method": "POST",
  "url": "{{ _.base_url }}/api/users",
  "headers": [
    {
      "name": "Content-Type",
      "value": "application/json"
    },
    {
      "name": "Authorization",
      "value": "Bearer {{ _.bearer_token }}"
    }
  ],
  "body": {
    "mimeType": "application/json",
    "text": "{\n  \"name\": \"John Doe\",\n  \"email\": \"john@example.com\",\n  \"password\": \"secret123\"\n}"
  }
}
```

## ğŸ› ï¸ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¨­å®š

```php
// config/spectrum.php
'export' => [
    'postman' => [
        // Postmanã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³
        'version' => '2.1.0',
        
        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å¤‰æ•°
        'variables' => [
            'base_url' => env('APP_URL', 'http://localhost:8000'),
            'api_version' => 'v1',
        ],
        
        // èªè¨¼ãƒ—ãƒªã‚»ãƒƒãƒˆ
        'auth_presets' => [
            'bearer' => [
                'type' => 'bearer',
                'bearer' => [
                    'token' => '{{bearer_token}}'
                ]
            ],
        ],
        
        // ãƒ†ã‚¹ãƒˆç”Ÿæˆè¨­å®š
        'generate_tests' => true,
        'test_templates' => [
            'status_check' => true,
            'response_time' => true,
            'schema_validation' => true,
        ],
    ],
    
    'insomnia' => [
        // ç’°å¢ƒè¨­å®š
        'environments' => [
            'development' => [
                'base_url' => 'http://localhost:8000',
                'bearer_token' => '',
            ],
            'staging' => [
                'base_url' => 'https://staging.example.com',
                'bearer_token' => '',
            ],
            'production' => [
                'base_url' => 'https://api.example.com',
                'bearer_token' => '',
            ],
        ],
        
        // ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ 
        'folder_by_tags' => true,
        'folder_icons' => [
            'Authentication' => 'ğŸ”',
            'Users' => 'ğŸ‘¥',
            'Admin' => 'ğŸ‘¨â€ğŸ’¼',
        ],
    ],
],
```

### ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼

ç‹¬è‡ªã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå½¢å¼ã‚’è¿½åŠ ï¼š

```php
namespace App\Spectrum\Formatters;

use LaravelSpectrum\Contracts\ExportFormatter;

class CustomFormatter implements ExportFormatter
{
    public function format(array $openapi): array
    {
        // OpenAPIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã‚«ã‚¹ã‚¿ãƒ å½¢å¼ã«å¤‰æ›
        return [
            'version' => '1.0',
            'endpoints' => $this->transformEndpoints($openapi['paths']),
            // ...
        ];
    }
}
```

ç™»éŒ²ï¼š

```php
// AppServiceProvider.php
use LaravelSpectrum\Facades\Spectrum;

public function boot()
{
    Spectrum::addFormatter('custom', CustomFormatter::class);
}
```

ä½¿ç”¨ï¼š

```bash
php artisan spectrum:export --format=custom --output=api.custom.json
```

## ğŸ”„ ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ‰‹é †

### Postmanã¸ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

1. Postmanã‚’é–‹ã
2. å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ã€ŒImportã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ã€ŒUpload Filesã€ã‚’é¸æŠ
4. ç”Ÿæˆã•ã‚ŒãŸ `collection.json` ã‚’é¸æŠ
5. ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚åŒæ§˜ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
6. ç’°å¢ƒã‚’é¸æŠã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å®Ÿè¡Œ

### Insomniaã¸ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

1. Insomniaã‚’é–‹ã
2. Application â†’ Preferences â†’ Data â†’ Import Data
3. ã€ŒFrom Fileã€ã‚’é¸æŠ
4. ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
5. ã‚¤ãƒ³ãƒãƒ¼ãƒˆè¨­å®šã‚’ç¢ºèª
6. ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¦ãƒ†ã‚¹ãƒˆé–‹å§‹

## ğŸ”§ é«˜åº¦ãªä½¿ç”¨æ–¹æ³•

### CI/CDã§ã®è‡ªå‹•ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

```yaml
# .github/workflows/export-api.yml
name: Export API Documentation

on:
  push:
    branches: [main]
    paths:
      - 'app/Http/**'
      - 'routes/**'

jobs:
  export:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.2'
          
      - name: Install Dependencies
        run: composer install
        
      - name: Generate OpenAPI
        run: php artisan spectrum:generate
        
      - name: Export to Postman
        run: |
          php artisan spectrum:export:postman \
            --output=postman/collection.json \
            --environment
            
      - name: Export to Insomnia  
        run: |
          php artisan spectrum:export:insomnia \
            --output=insomnia/workspace.json
            
      - name: Commit changes
        uses: EndBug/add-and-commit@v9
        with:
          add: 'postman/* insomnia/*'
          message: 'Update API exports'
```

### ãƒãƒ¼ãƒ å…±æœ‰

#### Postman Team Workspace

```bash
# ãƒãƒ¼ãƒ ç”¨ã®è¨­å®šã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
php artisan spectrum:export:postman \
    --team-id=your-team-id \
    --include-monitors \
    --include-mocks
```

#### Insomnia Git Sync

```bash
# GitåŒæœŸç”¨ã®è¨­å®šã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
php artisan spectrum:export:insomnia \
    --git-sync \
    --no-ids  # IDã‚’é™¤å¤–ã—ã¦ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã‚’é˜²ã
```

## ğŸ’¡ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. ç’°å¢ƒå¤‰æ•°ã®æ´»ç”¨

ã™ã¹ã¦ã®ç’°å¢ƒä¾å­˜å€¤ã‚’å¤‰æ•°åŒ–ï¼š

```json
{
  "base_url": "{{base_url}}",
  "api_key": "{{api_key}}",
  "timeout": "{{request_timeout}}"
}
```

### 2. ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã®æ•´ç†

ã‚¿ã‚°ã”ã¨ã«ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã¦æ•´ç†ï¼š

```
â”œâ”€â”€ Authentication
â”‚   â”œâ”€â”€ Login
â”‚   â”œâ”€â”€ Logout
â”‚   â””â”€â”€ Refresh Token
â”œâ”€â”€ Users
â”‚   â”œâ”€â”€ List Users
â”‚   â”œâ”€â”€ Create User
â”‚   â””â”€â”€ Update User
â””â”€â”€ Admin
    â”œâ”€â”€ Dashboard
    â””â”€â”€ Reports
```

### 3. ãƒ†ã‚¹ãƒˆã®è‡ªå‹•åŒ–

ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ™‚ã«åŸºæœ¬çš„ãªãƒ†ã‚¹ãƒˆã‚’å«ã‚ã‚‹ï¼š

```javascript
// ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰
pm.test("Success response", () => {
    pm.response.to.have.status(200);
});

// ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ 
pm.test("Response time < 500ms", () => {
    pm.expect(pm.response.responseTime).to.be.below(500);
});
```

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [åŸºæœ¬çš„ãªä½¿ã„æ–¹](./basic-usage.md) - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆã®åŸºæœ¬
- [CI/CDçµ±åˆ](./ci-cd-integration.md) - è‡ªå‹•åŒ–è¨­å®š
- [ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º](./customization.md) - é«˜åº¦ãªã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º